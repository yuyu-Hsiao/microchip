# 電動馬達打釘機控制系統

## 專案概述
本專案實現了一個電動馬達驅動的自動打釘機系統。透過單晶片 PIC16F1823 微控制器控制馬達運作，結合霍爾感測器精確控制馬達轉動至指定位置後，驅動釘槍進行擊發。此系統具備精確定位、自動打釘以及安全保護等功能，適合應用於高效率的自動化釘槍作業中。

## 功能特色
- **精確定位**：透過霍爾感測器檢測馬達位置，確保馬達旋轉至正確位置進行打釘。
- **自動打釘**：自動檢測物件並觸發打釘動作，提高操作效率。
- **電力管理**：當電池電量低或系統閒置時自動進行休眠，延長設備使用壽命。
- **LED 指示燈**：以 LED 顯示設備狀態，如電池電量不足或馬達過載警示。
- **過載保護**：當偵測到馬達過載時，自動停止以避免損壞。

## 系統架構與程式碼概述

### 1. `main.c` - 主程式
- **系統初始化**：透過 `SYSTEM_Initialize()` 函式進行裝置初始化，並開啟全域中斷。
- **主迴圈**：以 1 毫秒為基礎的迴圈，持續執行以下操作：
  - **輸入取樣**：呼叫 `input_sample()` 函式檢測霍爾傳感器、物件檢測及板機狀態。
  - **馬達控制**：透過 `motor()` 函式實現精確旋轉並觸發打釘動作。
  - **電力管理**：呼叫 `PowerDown_time()` 函式檢查電力狀態並進行省電操作。

### 2. `user.c` - 功能模組
- **中斷處理**：處理 Timer 和 I/O 的中斷，以觸發 ADC 轉換及馬達和物件檢測的即時反應。
- **ADC 轉換**：讀取電壓及電流，並檢查電池電量和負載狀態，以確保設備正常運行。
- **馬達控制邏輯**：包含 `motor()` 和 `motor_off()`，控制馬達的啟動、定位及停止，以配合打釘作業。
- **LED 指示燈控制**：`led_indicate()` 函式控制 LED 的顯示，根據不同的狀態進行閃爍顯示，提示操作人員。
- **電力管理與休眠**：`power_down()` 函式在電池電量不足或閒置狀態下將系統進入休眠，並在重新觸發時喚醒。

### 3. `user.h` - 定義與全域變數
- **常數與引腳定義**：包括霍爾傳感器、物件檢測、板機按鍵等輸入/輸出腳位配置。
- **ADC 設定**：定義電壓與電流讀取通道，以及電池電量閾值，以提供電力監控依據。
- **旗標與計時器**：包含電池低電量、馬達超時、物件偵測等旗標，用以追蹤各項狀態。

### 4. `電動馬達打釘槍.pdf` - 電路設計
電動馬達打釘機的電路設計圖，顯示了微控制器與各個感測元件、驅動電路的連接方式，並展示了電力管理的佈局。

## 系統運作流程
1. **啟動系統**：按下板機開關啟動打釘機，LED 指示燈亮起表示準備就緒。
2. **精確旋轉定位**：馬達啟動並旋轉，霍爾感測器檢測至正確位置後停止旋轉。
3. **自動打釘**：當偵測到物件後自動啟動釘槍進行打釘動作。
4. **電力管理**：當系統閒置或電量不足時，LED 顯示警示並自動進入低功耗模式。
5. **過載保護**：如偵測到馬達過載則立即停止，避免設備損壞。


## 目錄結構
```plaintext
打釘機/
├── 電動馬達打釘槍.pdf   # 電路設計圖
├── Program/
│   ├── main.c          # 主程式
│   ├── user.c          # 各功能模組
│   └── user.h          # 定義與全域變數
